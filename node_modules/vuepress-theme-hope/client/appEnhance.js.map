{"version":3,"file":"appEnhance.js","sources":["../src/client/composables/scrollPromise.ts","../src/client/components/NavLink.vue","../src/client/components/NavLink.vue?vue&type=template&id=af283642&lang.js","../src/client/appEnhance.ts"],"sourcesContent":["export interface ScrollPromise {\n  wait(): Promise<void> | null;\n  pending: () => void;\n  resolve: () => void;\n}\n\nlet promise: Promise<void> | null = null;\nlet promiseResolve: (() => void) | null = null;\n\nconst scrollPromise: ScrollPromise = {\n  wait: () => promise,\n  pending: () => {\n    promise = new Promise((resolve) => (promiseResolve = resolve));\n  },\n  resolve: () => {\n    promiseResolve?.();\n    promise = null;\n    promiseResolve = null;\n  },\n};\n\nexport const useScrollPromise = (): ScrollPromise => scrollPromise;\n","<template>\n  <RouterLink\n    v-if=\"isRouterLink\"\n    class=\"nav-link\"\n    :class=\"{ active: isActive }\"\n    :to=\"item.link\"\n    :aria-label=\"linkAriaLabel\"\n    v-bind=\"$attrs\"\n    @focusout=\"focusoutAction\"\n  >\n    <slot name=\"before\">\n      <i v-if=\"item.icon\" :class=\"`iconfont ${iconPrefix}${item.icon}`\" />\n    </slot>\n    {{ item.text }}\n    <slot name=\"after\" />\n  </RouterLink>\n  <a\n    v-else\n    class=\"nav-link external\"\n    :href=\"item.link\"\n    :rel=\"linkRel\"\n    :target=\"linkTarget\"\n    :aria-label=\"linkAriaLabel\"\n    v-bind=\"$attrs\"\n    @focusout=\"focusoutAction\"\n  >\n    <slot name=\"before\">\n      <i v-if=\"item.icon\" :class=\"`iconfont ${iconPrefix}${item.icon}`\" />\n    </slot>\n    {{ item.text }}\n    <OutboundLink v-if=\"isBlankTarget\" />\n    <slot name=\"after\" />\n  </a>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, toRefs } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport { useSiteData } from \"@vuepress/client\";\nimport { useIconPrefix } from \"@mr-hope/vuepress-shared/client\";\nimport { isLinkHttp, isLinkMailto, isLinkTel } from \"@vuepress/shared\";\n\nimport type { PropType } from \"vue\";\nimport type { NavLink } from \"../../shared\";\n\nexport default defineComponent({\n  name: \"NavLink\",\n\n  inheritAttrs: false,\n\n  props: {\n    item: {\n      type: Object as PropType<NavLink>,\n      required: true,\n    },\n    exact: {\n      type: Boolean,\n      default: false,\n    },\n  },\n\n  emits: [\"focusout\"],\n\n  setup(props, { emit }) {\n    const route = useRoute();\n    const site = useSiteData();\n    const iconPrefix = useIconPrefix();\n\n    const { item } = toRefs(props);\n\n    // if the link has http protocol\n    const hasHttpProtocol = computed(() => isLinkHttp(item.value.link));\n\n    // if the link has non-http protocol\n    const hasNonHttpProtocal = computed(\n      () => isLinkMailto(item.value.link) || isLinkTel(item.value.link)\n    );\n\n    // resolve the `target` attr\n    const linkTarget = computed(() =>\n      hasNonHttpProtocal.value\n        ? undefined\n        : item.value.target\n        ? item.value.target\n        : hasHttpProtocol.value\n        ? \"_blank\"\n        : undefined\n    );\n\n    // if the `target` attr is '_blank'\n    const isBlankTarget = computed(() => linkTarget.value === \"_blank\");\n\n    // is `<RouterLink>` or not\n    const isRouterLink = computed(\n      () =>\n        !hasHttpProtocol.value &&\n        !hasNonHttpProtocal.value &&\n        !isBlankTarget.value\n    );\n\n    // resolve the `rel` attr\n    const linkRel = computed(() =>\n      hasNonHttpProtocal.value\n        ? undefined\n        : item.value.rel\n        ? item.value.rel\n        : isBlankTarget.value\n        ? \"noopener noreferrer\"\n        : undefined\n    );\n\n    // resolve the `aria-label` attr\n    const linkAriaLabel = computed(\n      () => item.value.ariaLabel || item.value.text\n    );\n\n    // should be active when current route is a subpath of this link\n    const shouldBeActiveInSubpath = computed(() => {\n      if (props.exact) return false;\n\n      const localeKeys = Object.keys(site.value.locales);\n      if (localeKeys.length) {\n        return !localeKeys.some((key) => key === item.value.link);\n      }\n      return item.value.link !== \"/\";\n    });\n\n    // if this link is active in subpath\n    const isActive = computed(() => {\n      if (!isRouterLink.value || !shouldBeActiveInSubpath.value) {\n        return false;\n      }\n      return route.path.startsWith(item.value.link);\n    });\n\n    const focusoutAction = (): void => emit(\"focusout\");\n\n    return {\n      isActive,\n      iconPrefix,\n      isBlankTarget,\n      isRouterLink,\n      linkRel,\n      linkTarget,\n      linkAriaLabel,\n\n      focusoutAction,\n    };\n  },\n});\n</script>\n","<template>\n  <RouterLink\n    v-if=\"isRouterLink\"\n    class=\"nav-link\"\n    :class=\"{ active: isActive }\"\n    :to=\"item.link\"\n    :aria-label=\"linkAriaLabel\"\n    v-bind=\"$attrs\"\n    @focusout=\"focusoutAction\"\n  >\n    <slot name=\"before\">\n      <i v-if=\"item.icon\" :class=\"`iconfont ${iconPrefix}${item.icon}`\" />\n    </slot>\n    {{ item.text }}\n    <slot name=\"after\" />\n  </RouterLink>\n  <a\n    v-else\n    class=\"nav-link external\"\n    :href=\"item.link\"\n    :rel=\"linkRel\"\n    :target=\"linkTarget\"\n    :aria-label=\"linkAriaLabel\"\n    v-bind=\"$attrs\"\n    @focusout=\"focusoutAction\"\n  >\n    <slot name=\"before\">\n      <i v-if=\"item.icon\" :class=\"`iconfont ${iconPrefix}${item.icon}`\" />\n    </slot>\n    {{ item.text }}\n    <OutboundLink v-if=\"isBlankTarget\" />\n    <slot name=\"after\" />\n  </a>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, toRefs } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport { useSiteData } from \"@vuepress/client\";\nimport { useIconPrefix } from \"@mr-hope/vuepress-shared/client\";\nimport { isLinkHttp, isLinkMailto, isLinkTel } from \"@vuepress/shared\";\n\nimport type { PropType } from \"vue\";\nimport type { NavLink } from \"../../shared\";\n\nexport default defineComponent({\n  name: \"NavLink\",\n\n  inheritAttrs: false,\n\n  props: {\n    item: {\n      type: Object as PropType<NavLink>,\n      required: true,\n    },\n    exact: {\n      type: Boolean,\n      default: false,\n    },\n  },\n\n  emits: [\"focusout\"],\n\n  setup(props, { emit }) {\n    const route = useRoute();\n    const site = useSiteData();\n    const iconPrefix = useIconPrefix();\n\n    const { item } = toRefs(props);\n\n    // if the link has http protocol\n    const hasHttpProtocol = computed(() => isLinkHttp(item.value.link));\n\n    // if the link has non-http protocol\n    const hasNonHttpProtocal = computed(\n      () => isLinkMailto(item.value.link) || isLinkTel(item.value.link)\n    );\n\n    // resolve the `target` attr\n    const linkTarget = computed(() =>\n      hasNonHttpProtocal.value\n        ? undefined\n        : item.value.target\n        ? item.value.target\n        : hasHttpProtocol.value\n        ? \"_blank\"\n        : undefined\n    );\n\n    // if the `target` attr is '_blank'\n    const isBlankTarget = computed(() => linkTarget.value === \"_blank\");\n\n    // is `<RouterLink>` or not\n    const isRouterLink = computed(\n      () =>\n        !hasHttpProtocol.value &&\n        !hasNonHttpProtocal.value &&\n        !isBlankTarget.value\n    );\n\n    // resolve the `rel` attr\n    const linkRel = computed(() =>\n      hasNonHttpProtocal.value\n        ? undefined\n        : item.value.rel\n        ? item.value.rel\n        : isBlankTarget.value\n        ? \"noopener noreferrer\"\n        : undefined\n    );\n\n    // resolve the `aria-label` attr\n    const linkAriaLabel = computed(\n      () => item.value.ariaLabel || item.value.text\n    );\n\n    // should be active when current route is a subpath of this link\n    const shouldBeActiveInSubpath = computed(() => {\n      if (props.exact) return false;\n\n      const localeKeys = Object.keys(site.value.locales);\n      if (localeKeys.length) {\n        return !localeKeys.some((key) => key === item.value.link);\n      }\n      return item.value.link !== \"/\";\n    });\n\n    // if this link is active in subpath\n    const isActive = computed(() => {\n      if (!isRouterLink.value || !shouldBeActiveInSubpath.value) {\n        return false;\n      }\n      return route.path.startsWith(item.value.link);\n    });\n\n    const focusoutAction = (): void => emit(\"focusout\");\n\n    return {\n      isActive,\n      iconPrefix,\n      isBlankTarget,\n      isRouterLink,\n      linkRel,\n      linkTarget,\n      linkAriaLabel,\n\n      focusoutAction,\n    };\n  },\n});\n</script>\n","import { defineClientAppEnhance } from \"@vuepress/client\";\nimport { h } from \"vue\";\nimport { useScrollPromise } from \"./composables\";\n\nimport type { RouterScrollBehavior } from \"vue-router\";\n\nimport \"./styles/index.scss\";\n\nexport default defineClientAppEnhance(({ app, router }) => {\n  // compat with @vuepress/plugin-docsearch and @vuepress/plugin-search\n  app.component(\"NavbarSearch\", () => {\n    const SearchComponent =\n      app.component(\"Docsearch\") || app.component(\"SearchBox\");\n    if (SearchComponent) {\n      return h(SearchComponent);\n    }\n    return null;\n  });\n\n  // handle scrollBehavior with transition\n  const scrollBehavior = router.options.scrollBehavior as RouterScrollBehavior;\n\n  // eslint-disable-next-line @typescript-eslint/explicit-function-return-type\n  router.options.scrollBehavior = async (...args) => {\n    await useScrollPromise().wait();\n    return scrollBehavior(...args);\n  };\n});\n"],"names":["promise","promiseResolve","scrollPromise","wait","pending","Promise","resolve","defineComponent","name","inheritAttrs","props","item","type","Object","required","exact","Boolean","default","emits","[object Object]","emit","route","useRoute","site","useSiteData","iconPrefix","useIconPrefix","toRefs","hasHttpProtocol","computed","isLinkHttp","value","link","hasNonHttpProtocal","isLinkMailto","isLinkTel","linkTarget","undefined","target","isBlankTarget","isRouterLink","linkRel","rel","linkAriaLabel","ariaLabel","text","shouldBeActiveInSubpath","localeKeys","keys","locales","length","some","key","isActive","path","startsWith","focusoutAction","_ctx","_createBlock","_mergeProps","class","to","aria-label","onFocusout","_renderSlot","icon","href","defineClientAppEnhance","app","router","component","SearchComponent","h","scrollBehavior","options","async","args"],"mappings":"ujBAMA,IAAIA,EAAgC,KAChCC,EAAsC,KAE1C,MAAMC,EAA+B,CACnCC,KAAM,IAAMH,EACZI,QAAS,KACPJ,EAAU,IAAIK,SAASC,GAAaL,EAAiBK,KAEvDA,QAAS,KACPL,MACAD,EAAU,KACVC,EAAiB,OC4BrB,MAAeM,EAAgB,CAC7BC,KAAM,UAENC,cAAc,EAEdC,MAAO,CACLC,KAAM,CACJC,KAAMC,OACNC,UAAU,GAEZC,MAAO,CACLH,KAAMI,QACNC,SAAS,IAIbC,MAAO,CAAC,YAERC,MAAMT,GAAOU,KAAEA,IACb,MAAMC,EAAQC,IACRC,EAAOC,IACPC,EAAaC,KAEbf,KAAEA,GAASgB,EAAOjB,GAGlBkB,EAAkBC,GAAS,IAAMC,EAAWnB,EAAKoB,MAAMC,QAGvDC,EAAqBJ,GACzB,IAAMK,EAAavB,EAAKoB,MAAMC,OAASG,EAAUxB,EAAKoB,MAAMC,QAIxDI,EAAaP,GAAS,IAC1BI,EAAmBF,WACfM,EACA1B,EAAKoB,MAAMO,OACX3B,EAAKoB,MAAMO,OACXV,EAAgBG,MAChB,cACAM,IAIAE,EAAgBV,GAAS,IAA2B,WAArBO,EAAWL,QAG1CS,EAAeX,GACnB,KACGD,EAAgBG,QAChBE,EAAmBF,QACnBQ,EAAcR,QAIbU,EAAUZ,GAAS,IACvBI,EAAmBF,WACfM,EACA1B,EAAKoB,MAAMW,IACX/B,EAAKoB,MAAMW,IACXH,EAAcR,MACd,2BACAM,IAIAM,EAAgBd,GACpB,IAAMlB,EAAKoB,MAAMa,WAAajC,EAAKoB,MAAMc,OAIrCC,EAA0BjB,GAAS,KACvC,GAAInB,EAAMK,MAAO,OAAO,EAExB,MAAMgC,EAAalC,OAAOmC,KAAKzB,EAAKQ,MAAMkB,SAC1C,OAAIF,EAAWG,QACLH,EAAWI,MAAMC,GAAQA,IAAQzC,EAAKoB,MAAMC,OAE3B,MAApBrB,EAAKoB,MAAMC,QAapB,MAAO,CACLqB,SAVexB,GAAS,OACnBW,EAAaT,QAAUe,EAAwBf,QAG7CV,EAAMiC,KAAKC,WAAW5C,EAAKoB,MAAMC,QAOxCP,WAAAA,EACAc,cAAAA,EACAC,aAAAA,EACAC,QAAAA,EACAL,WAAAA,EACAO,cAAAA,EAEAa,eAXqB,IAAYpC,EAAK,kGCrIlCqC,EAAY,kBADpBC,IAAAC,SAEEC,OAAM,mBACYH,aACjBI,GAAIJ,OAAKzB,KACT8B,aAAYL,iBACLA,UACPM,WAAUN,+BAEX,KAAAO,wBAAA,KACWP,OAAS,UAAlBC,aAAqBE,kBAAmBH,eAAaA,OAAKQ,yCAEzDR,OAAKZ,aACRmB,+EAEFN,MAAAC,SAEEC,MAAM,oBACLM,KAAMT,OAAKzB,KACXU,IAAKe,UACLnB,OAAQmB,aACRK,aAAYL,iBACLA,UACPM,+BAAUN,6CAEXO,wBAAA,KACWP,OAAS,UAAlBC,aAAqBE,kBAAmBH,eAAaA,OAAKQ,yCAEzDR,OAAKZ,aACYY,EAAa,mBAAjCC,2BACAM,6GCvBJ,MAAeG,GAAuB,EAAGC,IAAAA,EAAKC,OAAAA,MAE5CD,EAAIE,UAAU,gBAAgB,KAC5B,MAAMC,EACJH,EAAIE,UAAU,cAAgBF,EAAIE,UAAU,aAC9C,OAAIC,EACKC,EAAED,GAEJ,QAIT,MAAME,EAAiBJ,EAAOK,QAAQD,eAGtCJ,EAAOK,QAAQD,eAAiBE,SAAUC,WHFS1E,EGGxBC,OAClBsE,KAAkBG"}