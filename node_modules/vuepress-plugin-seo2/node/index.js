"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@vuepress/core"),t=require("@mr-hope/vuepress-shared"),a=require("fs-extra");const r=(e,t)=>`${e}${t.replace(/^\//u,"")}`,o=new t.Logger("Seo"),n=(e,a,{page:o,app:n,permalink:i})=>{const{frontmatter:{author:s,time:l,date:c=l,banner:g,cover:m,tag:u,tags:p=u},git:d={}}=o,{siteData:f}=n,h=((e={})=>{const t=[];for(const a in e)e[a].lang&&t.push(e[a].lang);return t})(f.locales),w=["article","category","tag","timeline"].some((e=>o.filePathRelative&&o.filePathRelative.startsWith(`/${e}`)))?"website":"article",b=!1===s?"":s||e.author||n.options.themeConfig.author||"",{updatedTime:y}=d,v=y?new Date(y).toISOString():"",x=Array.isArray(p)?p:"string"==typeof u?[u]:[];let D="";if(c instanceof Date)D=new Date(c).toISOString();else if(c){const e=t.getDate(c);e&&e.value&&(D=e.value.toISOString())}return{"og:url":r(a,i||o.path),"og:site_name":f.title,"og:title":o.title,"og:description":o.frontmatter.description||"","og:type":w,"og:image":m?r(a,m):g?r(a,g):"","og:updated_time":v,"og:locale":o.lang,"og:locale:alternate":h,"twitter:card":"summary_large_image","twitter:image:alt":f.title,"article:author":b,"article:tag":x,"article:published_time":D,"article:modified_time":v}},i=(e,{name:t,content:a,attribute:r=(["article:","og:"].some((e=>t.startsWith(e)))?"property":"name")})=>{a&&e.push(["meta",{[r]:t,content:a}])},s=(t,r)=>{const{base:s,themeConfig:l}=r.options,c=Object.keys(t).length>0?t:l.seo||{};return{name:"seo2",extendsPageData(t){const a=t.frontmatter.head||[],o={page:t,app:r,permalink:e.resolvePagePermalink(t)};return((e,t,a)=>{for(const a in t)switch(a){case"article:tag":t["article:tag"].forEach((t=>i(e,{name:"article:tag",content:t})));break;case"og:locale:alternate":t["og:locale:alternate"].forEach((a=>{a!==t["og:locale"]&&i(e,{name:"og:locale:alternate",content:a})}));break;default:i(e,{name:a,content:t[a]})}a.restrictions&&i(e,{name:"og:restrictions:age",content:a.restrictions}),a.twitterID&&i(e,{name:"twitter:creator",content:a.twitterID})})(a,{...n(c,s,o),...c.seo?c.seo(o):{}},c),c.customHead&&c.customHead(a,o),{frontmatter:{...t.frontmatter,head:a}}},async onGenerated(){await(async e=>{o.load("Generating robots.txt");const t=e.public("robots.txt");let r=a.existsSync(t)?await a.readFile(t,{encoding:"utf8"}):"";r&&!r.includes("User-agent")?(o.error(),o.update("robots.txt seems invalid!")):(r+="\nUser-agent:*\nDisallow:\n",await a.writeFile(e.dest("robots.txt"),r,{flag:"w"}),o.success())})(r.dir)}}};exports.default=s,exports.seoPlugin=s;
//# sourceMappingURL=index.js.map
